<!DOCTYPE html>
<html lang="ko">
<head>
    <%- include('../partials/head') %>
    <style>
        .mypage-container { max-width: 1000px; margin: 40px auto; padding: 20px; }
        .order-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .order-table th, .order-table td { padding: 15px; border-bottom: 1px solid #ddd; text-align: center; }
        .order-table th { background: #f9f9f9; border-top: 2px solid #333; }
        
        .status-badge { padding: 5px 10px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
        .status-PENDING { background: #ffeaa7; color: #d35400; } /* ì…ê¸ˆëŒ€ê¸° */
        .status-PAID { background: #55efc4; color: #00b894; }    /* ê²°ì œì™„ë£Œ */
        .status-CANCELLED { background: #dfe6e9; color: #636e72; text-decoration: line-through; }
        .status-SHIPPED { background: #74b9ff; color: #0984e3; }

        .btn-cancel { background: #ff7675; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; }
        .btn-cancel:hover { background: #d63031; }
    </style>
</head>
<body>
    <%- include('../partials/header') %>

    <main class="mypage-container">
        <h2>ğŸ“œ ë‚´ ì£¼ë¬¸ ë‚´ì—­</h2>

        <% if (orders.length > 0) { %>
            <table class="order-table">
                <thead>
                    <tr>
                        <th>ì£¼ë¬¸ë²ˆí˜¸</th>
                        <th>ì£¼ë¬¸ì¼ì</th>
                        <th>ê²°ì œê¸ˆì•¡</th>
                        <th>ìƒíƒœ</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody>
                    <% orders.forEach(order => { %>
                        <tr>
                            <td>#<%= order.id %></td>
                            <td><%= new Date(order.created_at).toLocaleDateString() %></td>
                            <td style="font-weight: bold;">â‚© <%= order.final_amount.toLocaleString() %></td>
                            <td>
                                <span class="status-badge status-<%= order.status %>">
                                    <% if (order.status === 'PENDING') { %> ì…ê¸ˆëŒ€ê¸°
                                    <% } else if (order.status === 'PAID') { %> ê²°ì œì™„ë£Œ
                                    <% } else if (order.status === 'CANCELLED') { %> ì·¨ì†Œë¨
                                    <% } else if (order.status === 'SHIPPED') { %> ë°°ì†¡ì¤‘
                                    <% } else { %> <%= order.status %> <% } %>
                                </span>
                            </td>
                            <td>
                                <% if (order.status === 'PENDING' || order.status === 'PAID') { %>
                                    <form action="/orders/<%= order.id %>/cancel" method="POST" onsubmit="return confirm('ì •ë§ ì£¼ë¬¸ì„ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                                        <button type="submit" class="btn-cancel">ì£¼ë¬¸ ì·¨ì†Œ</button>
                                    </form>
                                <% } else if (order.status === 'CANCELLED') { %>
                                    -
                                <% } else { %>
                                    <button disabled style="opacity: 0.5;">ì·¨ì†Œ ë¶ˆê°€</button>
                                <% } %>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        <% } else { %>
            <div style="text-align: center; padding: 50px; color: #888;">
                <p>ì•„ì§ ì£¼ë¬¸ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                <a href="/products" style="color: blue; text-decoration: underline;">ì‡¼í•‘í•˜ëŸ¬ ê°€ê¸°</a>
            </div>
        <% } %>
    </main>

    <%- include('../partials/footer') %>
</body>
</html>