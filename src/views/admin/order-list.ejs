<!DOCTYPE html>
<html lang="ko">
<head>
    <%- include('../partials/head') %>
    <style>
        .admin-container { max-width: 1200px; margin: 40px auto; padding: 20px; }
        .admin-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
        .admin-table th, .admin-table td { padding: 12px; border-bottom: 1px solid #ddd; text-align: center; vertical-align: middle; }
        .admin-table th { background: #333; color: white; }
        
        .form-select { padding: 5px; border-radius: 4px; border: 1px solid #ccc; }
        .form-input { padding: 5px; border-radius: 4px; border: 1px solid #ccc; width: 100px; }
        .btn-update { padding: 5px 10px; background: #0984e3; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .btn-update:hover { background: #74b9ff; }
        
        /* ìƒíƒœë³„ ìƒ‰ìƒ (ì‹œê°ì  êµ¬ë¶„) */
        .status-PENDING { color: #d35400; font-weight: bold; }
        .status-PAID { color: #00b894; font-weight: bold; }
        .status-SHIPPED { color: #0984e3; font-weight: bold; }
        .status-CANCELLED { color: #aaa; text-decoration: line-through; }
    </style>
</head>
<body>
    <%- include('../partials/header') %>

    <main class="admin-container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h2>ğŸ“¦ ê´€ë¦¬ì ì£¼ë¬¸ ê´€ë¦¬</h2>
            <a href="/admin/products/new" style="padding: 10px 20px; background: #333; color: white; text-decoration: none; border-radius: 4px;">+ ìƒí’ˆ ë“±ë¡í•˜ëŸ¬ ê°€ê¸°</a>
        </div>

        <div style="overflow-x: auto;">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>No.</th>
                        <th>ì£¼ë¬¸ì¼ì‹œ</th>
                        <th>ì£¼ë¬¸ì</th>
                        <th>ê²°ì œê¸ˆì•¡</th>
                        <th>í˜„ì¬ìƒíƒœ</th>
                        <th>íƒë°°ì‚¬</th>
                        <th>ì†¡ì¥ë²ˆí˜¸</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (orders.length > 0) { %>
                        <% orders.forEach(order => { %>
                            <tr>
                                <td>#<%= order.id %></td>
                                <td><%= new Date(order.created_at).toLocaleString() %></td>
                                <td>
                                    <%= order.user_name %><br>
                                    <span style="font-size: 0.8em; color: gray;"><%= order.email %></span>
                                </td>
                                <td>â‚© <%= order.final_amount.toLocaleString() %></td>
                                
                                <form action="/admin/orders/<%= order.id %>/status" method="POST">
                                    <td>
                                        <select name="status" class="form-select status-<%= order.status %>">
                                            <option value="PENDING" <%= order.status === 'PENDING' ? 'selected' : '' %>>ì…ê¸ˆëŒ€ê¸°</option>
                                            <option value="PAID" <%= order.status === 'PAID' ? 'selected' : '' %>>ê²°ì œì™„ë£Œ</option>
                                            <option value="PREPARING" <%= order.status === 'PREPARING' ? 'selected' : '' %>>ë°°ì†¡ì¤€ë¹„</option>
                                            <option value="SHIPPED" <%= order.status === 'SHIPPED' ? 'selected' : '' %>>ë°°ì†¡ì¤‘</option>
                                            <option value="DELIVERED" <%= order.status === 'DELIVERED' ? 'selected' : '' %>>ë°°ì†¡ì™„ë£Œ</option>
                                            <option value="CANCELLED" <%= order.status === 'CANCELLED' ? 'selected' : '' %>>ì·¨ì†Œë¨</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="text" name="courier" class="form-input" placeholder="íƒë°°ì‚¬" value="<%= order.courier || '' %>">
                                    </td>
                                    <td>
                                        <input type="text" name="tracking_number" class="form-input" placeholder="ì†¡ì¥ë²ˆí˜¸" value="<%= order.tracking_number || '' %>" style="width: 150px;">
                                    </td>
                                    <td>
                                        <button type="submit" class="btn-update">ìˆ˜ì •</button>
                                    </td>
                                </form>
                                </tr>
                        <% }) %>
                    <% } else { %>
                        <tr>
                            <td colspan="8" style="padding: 50px;">ì ‘ìˆ˜ëœ ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                        </tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </main>

    <%- include('../partials/footer') %>
</body>
</html>